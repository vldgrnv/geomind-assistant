# Обновление (Update) пространственных данных

## 1. Введение и теоретические основы

Обновление (англ. *update*) — это операция overlay-анализа, направленная на **замещение частей целевого слоя объектами из обновляющего слоя** с сохранением оставшейся части исходного слоя. С геометрической точки зрения, update представляет собой комбинацию двух операций:  
1. **Вычитание** (erase) целевого слоя по маске обновляющего слоя,  
2. **Объединение** (merge) результата с обновляющим слоем.  

Формально результат можно выразить как:  
\[
C = (A \setminus B) \cup B
\]  
где \( A \) — целевой слой, \( B \) — обновляющий слой, а \( C \) — результирующий слой, содержащий **актуальные данные из \( B \)** и **оставшиеся неизменённые части из \( A \)**.

В контексте геоинформационных систем данная операция служит инструментом **актуализации пространственных данных** при наличии более точной или свежей информации для части территории. Например: обновление устаревших границ лесничеств новыми данными аэрофотосъёмки, замена фрагментов кадастровой карты после межевания, или корректировка генерального плана в зоне реконструкции. Update позволяет избежать полной перезаписи данных, сохраняя проверенную информацию вне зоны изменений.

Методологически обновление относится к классу **топологических операций над векторными данными** и реализует принцип **селективной актуализации**. В отличие от *merge* или *union*, update гарантирует, что в зоне перекрытия **всегда доминируют данные из обновляющего слоя**, что критически важно при работе с авторитетными источниками.

## 2. Ключевые слова и семантические триггеры

обновление, update, актуализация, замещение, замена, QGIS нет прямого аналога, ArcMap Update

## 3. Область применения

- **Кадастровый учёт**: замена устаревших границ участков новыми данными межевания.
- **Лесное хозяйство**: обновление границ лесничеств по результатам аэрофотосъёмки.
- **Градостроительство**: актуализация генерального плана в зонах реконструкции.
- **Экологический мониторинг**: замена старых границ заказников новыми данными полевых исследований.
- **Инфраструктурное планирование**: обновление схемы водоснабжения в реконструированных районах.
- **Управление ЧС**: замена прогнозных зон затопления актуальными данными с дронов.

## 4. Входные данные

- **Целевой слой (Input)**: полигональный слой, подлежащий частичной замене.
- **Обновляющий слой (Update Feature)**: полигональный слой с новыми данными.
- **Единая система координат** (рекомендуется метрическая проекция).
- **Топологическая корректность**: отсутствие самопересечений и щелей.
- **Семантическая совместимость**: оба слоя должны относиться к одной тематической категории.

> ⚠️ **Важно**: Обновляющий слой **должен полностью покрывать** зоны, подлежащие замене. Частичное перекрытие может привести к созданию щелей.

## 5. Выходные данные

- Новый полигональный слой, содержащий:
  - Все объекты обновляющего слоя,
  - Части целевого слоя, **не перекрытые** обновляющим слоем.
- Атрибутивная таблица:
  - Для обновлённых областей — поля из обновляющего слоя,
  - Для неизменённых областей — поля из целевого слоя.
- Геометрия объектов точно соответствует комбинации входных данных.

## 6. Программная реализация

### 6.1. QGIS (версия 3.28+)

В QGIS **отсутствует прямой инструмент** «Update». Однако операцию можно эмулировать через последовательность:

1. **Erase** целевого слоя по обновляющему:  
   `Вектор → Инструменты геообработки → Разность...`
2. **Merge** результата erase с обновляющим слоем:  
   `Обработка → Инструменты анализа → Объединить векторные слои...`

#### Особенности:
- Требует двухэтапной обработки,
- Атрибутивные таблицы могут потребовать ручного выравнивания,
- Доступен во всех версиях QGIS без ограничений.

### 6.2. ArcMap

Инструмент **Update** входит в состав модуля **Analysis Tools → Overlay**, но **требует лицензию Advanced (ArcInfo)**.

#### Доступ к инструменту:
1. Откройте **ArcToolbox**.
2. Перейдите: **Analysis Tools → Overlay → Update**.

#### Основные параметры:
- **Input Features**: целевой слой (подлежит обновлению).
- **Update Features**: обновляющий слой (новые данные).
- **Output Feature Class**: путь к выходному файлу.
- **Boundary Rule**:
  - *NO_BORDERS* — не сохранять внутренние границы между обновлёнными и неизменёнными частями,
  - *MAINTAIN_BORDERS* — сохранять все границы (по умолчанию).

#### Особенности версий 10.4–10.8:
- В ArcMap 10.4–10.6 инструмент может работать медленно с большими наборами данных (>50 000 объектов). Рекомендуется использовать **File Geodatabase**.
- Начиная с 10.7, улучшена обработка сложных полигонов с островками (holes).
- При работе с NULL-значениями в атрибутивных полях поведение зависит от настроек geodatabase.
- Инструмент **сохраняет топологию** результата, но может создавать микроскопические фрагменты (slivers) — их можно удалить через *Eliminate*.

#### Типичные сценарии:
- **Актуализация кадастра**:  
  Input = кадастр_2020.shp, Update = межевание_2025.shp → Output = кадастр_актуальный.shp
- **Обновление лесничеств**:  
  Input = леса_устаревшие.shp, Update = аэрофото_2025.shp → Output = леса_актуальные.shp

## 7. Примеры формулировок пользовательских запросов

- «Как обновить старые границы участков новыми данными межевания?»
- «Нужно заменить часть кадастровой карты новыми данными»
- «Как в ArcMap сделать update слоя?»
- «Актуализируй генплан в зоне реконструкции»
- «Замени старые границы заказника новыми данными»

## 8. Ограничения и особенности

1. **Требование к лицензии ArcMap**: update доступен только в Advanced-версии.
2. **Требование к типу геометрии**: оба слоя **должны быть полигональными**.
3. **Чувствительность к топологии**: наличие щелей между обновляющим и целевым слоями приведёт к некорректному результату.
4. **Производительность**: время выполнения растёт с увеличением числа объектов.
5. **Ограничения QGIS**: отсутствие прямого инструмента усложняет процесс для пользователей без программирования.

## 9. Научно-методическое обоснование

Обновление является ключевым элементом **цикла жизненного цикла геопространственных данных**, обеспечивая постепенную актуализацию без полной переработки. В учебниках по ГИС (например, Longley et al., *Geographic Information Science & Systems*, 2015) update рассматривается как базовая операция для поддержания актуальности картографических материалов.

## 10. Литература и нормативные источники

- Longley P. A., Goodchild M. F., Maguire D. J., Rhind D. W. *Geographic Information Science & Systems*. — 4th ed. — Wiley, 2015.
- ISO 19107:2003. *Geographic information — Spatial schema*.
- QGIS Documentation. *Difference, Merge Vector Layers*. URL: https://docs.qgis.org
- Esri. *Update (Analysis)*. ArcGIS Desktop Help (версии 10.4–10.8). URL: https://desktop.arcgis.com
